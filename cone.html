
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Spinning Line</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- MathJax for beautiful math equations -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Three.js for 3D Visualization -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        .math-step {
            @apply border-l-4 border-blue-500 pl-4 my-4 bg-blue-50 p-4 rounded-r;
        }
        .canvas-container {
            position: relative;
            height: 400px; /* Taller for 3D */
            width: 100%;
            background: #0f172a; /* Dark background for 3D */
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            overflow: hidden;
        }
        input[type=range] {
            -webkit-appearance: none; 
            background: transparent; 
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            margin-top: -8px; 
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: #cbd5e1;
            border-radius: 2px;
        }
        /* Custom toggle switch */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #3b82f6;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #3b82f6;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans">

    <!-- Header -->
    <header class="bg-blue-600 text-white p-6 shadow-lg">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-3xl font-bold mb-2">The Spinning Line Problem</h1>
            <p class="text-blue-100">Ritangle Question 11 - Stage 1 Walkthrough</p>
        </div>
    </header>

    <main class="max-w-4xl mx-auto p-6 space-y-8">

        <!-- Introduction -->
        <section class="bg-white p-6 rounded-xl shadow-sm">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">1. Visualizing the 3D Frustums</h2>
            <p class="mb-4">
                Drag the slider to change <strong>a</strong>. Toggle the switch to spin the line around the X or Y axis.
            </p>
            <p class="mb-6 text-sm text-gray-600 bg-gray-100 p-3 rounded">
                <strong>Interaction:</strong> Click and drag on the black window to rotate the camera view!
            </p>

            <!-- Interactive Visualization -->
            <div class="grid md:grid-cols-3 gap-6">
                <!-- Controls & Stats -->
                <div class="md:col-span-1 space-y-6">
                    <!-- Value Slider -->
                    <label class="block">
                        <span class="text-gray-700 font-bold">Value of a: <span id="val-a" class="text-blue-600">3.00</span></span>
                        <input type="range" id="slider-a" min="2.1" max="15" step="0.1" value="3" class="w-full mt-2">
                    </label>

                    <!-- Axis Toggle -->
                    <div class="flex flex-col gap-2">
                        <span class="font-bold text-gray-700">Rotation Axis:</span>
                        <div class="flex gap-2">
                            <button id="btn-x" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded shadow hover:bg-blue-700 transition" onclick="setAxis('x')">X-Axis</button>
                            <button id="btn-y" class="flex-1 bg-white text-gray-700 border border-gray-300 py-2 px-4 rounded shadow hover:bg-gray-50 transition" onclick="setAxis('y')">Y-Axis</button>
                        </div>
                    </div>

                    <!-- Stats Box -->
                    <div class="bg-blue-50 p-4 rounded-lg space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Vol (X-axis):</span>
                            <span id="vol-x" class="font-mono font-bold">---</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Vol (Y-axis):</span>
                            <span id="vol-y" class="font-mono font-bold">---</span>
                        </div>
                        <div class="flex justify-between border-t border-blue-200 pt-2 text-base">
                            <span>Difference:</span>
                            <span id="vol-diff" class="font-mono font-bold text-red-600">---</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1 text-center">Target difference is 50</p>
                    </div>
                </div>

                <!-- 3D Canvas -->
                <div class="md:col-span-2 canvas-container" id="canvas-container">
                    <!-- Three.js will inject canvas here -->
                    <div class="absolute top-2 left-2 text-white text-xs bg-black/50 p-2 rounded pointer-events-none">
                        <p>Red Line: X-Axis</p>
                        <p>Green Line: Y-Axis</p>
                        <p>Blue Shape: The Frustum</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Step 2: The Math -->
        <section class="bg-white p-6 rounded-xl shadow-sm">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">2. The Volume Formula</h2>
            <div class="flex items-start gap-4">
                <div class="bg-yellow-100 p-3 rounded-full text-2xl">ðŸ’¡</div>
                <div>
                    <p class="mb-2">A <strong>Frustum</strong> is a slice of a cone. The volume formula is:</p>
                    <div class="bg-gray-800 text-white p-4 rounded-lg text-center my-3 overflow-x-auto">
                        \[ V = \frac{1}{3} \pi h (R^2 + Rr + r^2) \]
                    </div>
                    <ul class="list-disc pl-5 space-y-1 text-sm text-gray-600">
                        <li>\( h \) = Height of the frustum (distance between circles)</li>
                        <li>\( R \) = Radius of the big circle</li>
                        <li>\( r \) = Radius of the small circle</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Step 3: X-Axis Rotation -->
        <section class="bg-white p-6 rounded-xl shadow-sm border-l-4 border-green-500">
            <h3 class="text-xl font-bold text-gray-900 mb-2">Step 3: Rotation about the X-axis</h3>
            <p class="mb-4">When we spin around the x-axis, the "height" is along the x-axis, and the "radii" are the y-values (height of the points).</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-green-50 p-4 rounded">
                    <h4 class="font-bold text-green-800 mb-2">Parameters</h4>
                    <ul class="space-y-2 text-sm">
                        <li><strong>Height (\(h\)):</strong> Change in x = \(12 - 1 = 11\)</li>
                        <li><strong>Small Radius (\(r\)):</strong> \(y_1 = 2\)</li>
                        <li><strong>Big Radius (\(R\)):</strong> \(y_2 = a\)</li>
                    </ul>
                </div>
                <div class="bg-white border p-4 rounded">
                    <h4 class="font-bold text-gray-800 mb-2">Calculation (\(V_x\))</h4>
                    <p class="text-sm">
                        \[ V_x = \frac{1}{3} \pi (11) (a^2 + 2a + 2^2) \]
                        \[ V_x = \frac{11\pi}{3} (a^2 + 2a + 4) \]
                    </p>
                </div>
            </div>
        </section>

        <!-- Step 4: Y-Axis Rotation -->
        <section class="bg-white p-6 rounded-xl shadow-sm border-l-4 border-purple-500">
            <h3 class="text-xl font-bold text-gray-900 mb-2">Step 4: Rotation about the Y-axis</h3>
            <p class="mb-4">When we spin around the y-axis, everything flips! The "height" is along the y-axis, and the "radii" are the x-values (distance from the axis).</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-purple-50 p-4 rounded">
                    <h4 class="font-bold text-purple-800 mb-2">Parameters</h4>
                    <ul class="space-y-2 text-sm">
                        <li><strong>Height (\(h\)):</strong> Change in y = \(a - 2\)</li>
                        <li><strong>Small Radius (\(r\)):</strong> \(x_1 = 1\)</li>
                        <li><strong>Big Radius (\(R\)):</strong> \(x_2 = 12\)</li>
                    </ul>
                </div>
                <div class="bg-white border p-4 rounded">
                    <h4 class="font-bold text-gray-800 mb-2">Calculation (\(V_y\))</h4>
                    <p class="text-sm">
                        \[ V_y = \frac{1}{3} \pi (a-2) (12^2 + 12(1) + 1^2) \]
                        \[ V_y = \frac{1}{3} \pi (a-2) (157) \]
                        \[ V_y = \frac{157\pi}{3} (a-2) \]
                    </p>
                </div>
            </div>
        </section>

        <!-- Step 5: Solving -->
        <section class="bg-white p-6 rounded-xl shadow-sm">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">Step 5: The Difference Equation</h2>
            <p class="mb-4">The problem states the difference is 50. Since we don't know which is bigger, we use the absolute value:</p>
            <div class="text-center text-lg font-bold my-4">
                \( | V_x - V_y | = 50 \)
            </div>
            
            <p>Let's remove the common factor \( \frac{\pi}{3} \) to make it cleaner. Let \( K = \frac{150}{\pi} \).</p>
            <p class="mt-2 text-center text-sm bg-gray-100 p-2 rounded">
                \( 11(a^2 + 2a + 4) - 157(a - 2) = \pm K \)
            </p>
            
            <p class="mt-4">Expanding and simplifying the left side:</p>
            <p class="pl-4 border-l-2 border-gray-300 ml-4 text-sm text-gray-600">
                \( 11a^2 + 22a + 44 - 157a + 314 \) <br>
                \( = 11a^2 - 135a + 358 \)
            </p>

            <p class="mt-4">This gives us two quadratic equations to solve:</p>
            <div class="grid md:grid-cols-2 gap-6 mt-4">
                <div class="border p-4 rounded bg-gray-50">
                    <h4 class="font-bold mb-2">Case 1 (+50)</h4>
                    <p class="text-sm">\( 11a^2 - 135a + 358 = \frac{150}{\pi} \)</p>
                    <p class="text-xs text-gray-500 mt-2">\( 11a^2 - 135a + (358 - \frac{150}{\pi}) = 0 \)</p>
                </div>
                <div class="border p-4 rounded bg-gray-50">
                    <h4 class="font-bold mb-2">Case 2 (-50)</h4>
                    <p class="text-sm">\( 11a^2 - 135a + 358 = -\frac{150}{\pi} \)</p>
                    <p class="text-xs text-gray-500 mt-2">\( 11a^2 - 135a + (358 + \frac{150}{\pi}) = 0 \)</p>
                </div>
            </div>
        </section>

        <!-- Step 6: Final Calculation -->
        <section class="bg-blue-600 text-white p-6 rounded-xl shadow-lg">
            <h2 class="text-2xl font-bold mb-4">Step 6: The Sum of Values</h2>
            <p class="mb-4">
                We need the sum of all valid \(a\). For a quadratic \(Ax^2 + Bx + C = 0\), the sum of roots is \( -B/A \).
            </p>
            <div class="bg-blue-700 p-4 rounded-lg mb-4">
                <p><strong>Check:</strong> Are the roots real and > 2?</p>
                <p class="text-sm text-blue-200 mt-1">Yes! By calculating the discriminant \(B^2 - 4AC\), we find both equations have 2 real roots, and because the vertex of the parabola is at \(a \approx 6.13\), all 4 intersection points occur where \(a > 2\).</p>
            </div>
            
            <p>
                Sum for Case 1: \( \frac{135}{11} \) <br>
                Sum for Case 2: \( \frac{135}{11} \)
            </p>
            
            <div class="mt-6 text-center">
                <p class="text-xl">Total Sum = \( \frac{270}{11} \)</p>
                <p class="text-4xl font-extrabold mt-2 text-yellow-300">24.545</p>
                <p class="text-sm opacity-75 mt-1">(to 3 decimal places)</p>
            </div>
        </section>

    </main>

    <footer class="text-center p-8 text-gray-500 text-sm">
        Generated for Ritual Question Study
    </footer>

    <script>
        // --- 1. Basic Setup & Math Logic ---
        const slider = document.getElementById('slider-a');
        const valA = document.getElementById('val-a');
        const volXDisplay = document.getElementById('vol-x');
        const volYDisplay = document.getElementById('vol-y');
        const volDiffDisplay = document.getElementById('vol-diff');
        let currentAxis = 'x'; // 'x' or 'y'

        function setAxis(axis) {
            currentAxis = axis;
            document.getElementById('btn-x').className = axis === 'x' 
                ? "flex-1 bg-blue-600 text-white py-2 px-4 rounded shadow hover:bg-blue-700 transition"
                : "flex-1 bg-white text-gray-700 border border-gray-300 py-2 px-4 rounded shadow hover:bg-gray-50 transition";
            document.getElementById('btn-y').className = axis === 'y' 
                ? "flex-1 bg-purple-600 text-white py-2 px-4 rounded shadow hover:bg-purple-700 transition"
                : "flex-1 bg-white text-gray-700 border border-gray-300 py-2 px-4 rounded shadow hover:bg-gray-50 transition";
            
            update3D();
        }

        // --- 2. Three.js Initialization ---
        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();
        // Camera setup
        const camera = new THREE.PerspectiveCamera(50, container.clientWidth / container.clientHeight, 0.1, 1000);
        camera.position.set(20, 15, 20); // Looking down at the origin
        camera.lookAt(5, 5, 0);

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(container.clientWidth, container.clientHeight);
        renderer.setClearColor(0x0f172a, 1);
        container.appendChild(renderer.domElement);

        // Lighting
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
        scene.add(ambientLight);
        const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
        dirLight.position.set(10, 20, 10);
        scene.add(dirLight);

        // Axis Helpers
        // Red = X, Green = Y, Blue = Z
        const axesHelper = new THREE.AxesHelper(20);
        scene.add(axesHelper);

        // Grid Helper
        const gridHelper = new THREE.GridHelper(40, 40, 0x334155, 0x1e293b);
        scene.add(gridHelper);

        // Frustum Mesh (We will update this geometry)
        let frustumMesh = null;
        let lineMesh = null;

        // Material for the frustum (transparent)
        const materialX = new THREE.MeshPhongMaterial({ 
            color: 0x3b82f6, 
            opacity: 0.6, 
            transparent: true,
            side: THREE.DoubleSide,
            shininess: 100
        });
        const materialY = new THREE.MeshPhongMaterial({ 
            color: 0xa855f7, 
            opacity: 0.6, 
            transparent: true,
            side: THREE.DoubleSide,
            shininess: 100
        });

        // --- 3. Interactive Camera Control (Simple Orbit) ---
        let isDragging = false;
        let previousMousePosition = { x: 0, y: 0 };
        let theta = Math.PI / 4; // Horizontal angle
        let phi = Math.PI / 3;   // Vertical angle
        const radius = 35;       // Distance from target

        container.addEventListener('mousedown', (e) => {
            isDragging = true;
        });
        document.addEventListener('mouseup', () => {
            isDragging = false;
        });
        document.addEventListener('mousemove', (e) => {
            if (isDragging) {
                const deltaMove = {
                    x: e.movementX,
                    y: e.movementY
                };

                theta -= deltaMove.x * 0.01;
                phi -= deltaMove.y * 0.01;

                // Clamp phi to prevent flipping
                phi = Math.max(0.1, Math.min(Math.PI - 0.1, phi));

                updateCameraPosition();
            }
        });

        function updateCameraPosition() {
            // Target is roughly center of action
            const target = new THREE.Vector3(6, 6, 0);
            
            camera.position.x = target.x + radius * Math.sin(phi) * Math.cos(theta);
            camera.position.y = target.y + radius * Math.cos(phi);
            camera.position.z = target.z + radius * Math.sin(phi) * Math.sin(theta);
            
            camera.lookAt(target);
        }
        updateCameraPosition(); // Init

        // --- 4. Main Update Loop ---
        function update3D() {
            const a = parseFloat(slider.value);
            
            // Remove old mesh
            if (frustumMesh) scene.remove(frustumMesh);
            if (lineMesh) scene.remove(lineMesh);

            // Create Frustum Geometry based on axis
            let geometry;
            
            if (currentAxis === 'x') {
                // X-Axis Rotation
                // Height = 11 (from x=1 to 12)
                // Radius at x=1 is y=2. Radius at x=12 is y=a.
                // CylinderGeometry(radiusTop, radiusBottom, height, segments)
                // Note: Three.js Cylinder is Y-aligned by default.
                // We need radiusTop to correspond to x=12 (value a) and radiusBottom to x=1 (value 2)
                // IF we rotate it -90deg around Z.
                
                geometry = new THREE.CylinderGeometry(2, a, 11, 32, 1, false); 
                // Wait, Cylinder centers at (0,0,0). 
                // We want it from x=1 to x=12.
                // Center x = (1+12)/2 = 6.5.
                
                frustumMesh = new THREE.Mesh(geometry, materialX);
                frustumMesh.rotation.z = -Math.PI / 2; // Rotate to lie on X
                frustumMesh.position.set(6.5, 0, 0);   // Center on X axis
            } else {
                // Y-Axis Rotation
                // Height = a - 2 (from y=2 to a)
                // Radius at y=2 is x=1. Radius at y=a is x=12.
                // Bottom (y=2) radius = 1. Top (y=a) radius = 12.
                
                const height = a - 2;
                const centerY = 2 + height/2;
                
                geometry = new THREE.CylinderGeometry(12, 1, height, 32, 1, false);
                frustumMesh = new THREE.Mesh(geometry, materialY);
                // Cylinder is already Y-aligned.
                frustumMesh.position.set(0, centerY, 0);
            }

            scene.add(frustumMesh);

            // Draw the original line segment in 3D space to show "generator"
            // (1, 2, 0) to (12, a, 0)
            const points = [];
            points.push(new THREE.Vector3(1, 2, 0));
            points.push(new THREE.Vector3(12, a, 0));
            const lineGeo = new THREE.BufferGeometry().setFromPoints(points);
            const lineMat = new THREE.LineBasicMaterial({ color: 0xffffff, linewidth: 2 });
            lineMesh = new THREE.Line(lineGeo, lineMat);
            // Move line slightly in front so it's visible
            lineMesh.position.z = 0.1; 
            scene.add(lineMesh);

            renderer.render(scene, camera);
        }

        function updateMath() {
            const a = parseFloat(slider.value);
            valA.textContent = a.toFixed(2);
            
            const PI = Math.PI;
            const volX = (11 * PI / 3) * (a*a + 2*a + 4);
            const volY = (157 * PI / 3) * (a - 2);
            const diff = Math.abs(volX - volY);

            volXDisplay.textContent = volX.toFixed(1);
            volYDisplay.textContent = volY.toFixed(1);
            volDiffDisplay.textContent = diff.toFixed(3);

            if (Math.abs(diff - 50) < 5) {
                volDiffDisplay.className = "font-mono font-bold text-green-600 text-xl";
            } else {
                volDiffDisplay.className = "font-mono font-bold text-red-600";
            }
        }

        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }
        
        // Listeners
        slider.addEventListener('input', () => {
            updateMath();
            update3D();
        });
        
        // Handle window resize
        window.addEventListener('resize', () => {
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        });

        // Init
        updateMath();
        update3D();
        animate(); // Start loop

    </script>
</body>
</html>
