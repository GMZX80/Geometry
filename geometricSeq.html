<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geometric Sequence Maximizer</title>
    
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --primary: #2563eb;
            --secondary: #475569;
            --accent-u: #059669; /* Green for Max */
            --accent-v: #dc2626; /* Red for Min */
            --bg: #f8fafc;
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background-color: var(--bg);
            color: #1e293b;
            line-height: 1.7;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* Typography */
        h1 { color: var(--primary); margin-bottom: 0.5rem; }
        h2 { color: var(--secondary); border-bottom: 2px solid #e2e8f0; padding-bottom: 10px; margin-top: 40px; }
        h3 { margin-top: 0; }
        
        /* Cards */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin-bottom: 25px;
        }

        .concept-box {
            background-color: #eff6ff;
            border-left: 5px solid var(--primary);
            padding: 15px 20px;
            margin: 20px 0;
        }

        /* Inputs Area */
        .interaction-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .interaction-area { grid-template-columns: 1fr; }
        }

        .sequence-u { border: 2px solid var(--accent-u); border-radius: 10px; padding: 20px; background: #ecfdf5; }
        .sequence-v { border: 2px solid var(--accent-v); border-radius: 10px; padding: 20px; background: #fef2f2; }

        .sequence-header {
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            display: block;
        }

        /* Input Styling */
        .input-row {
            margin-bottom: 15px;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }
        
        input[type="number"] {
            width: 60px;
            padding: 8px;
            border: 2px solid #cbd5e1;
            border-radius: 6px;
            text-align: center;
            font-size: 1.1em;
            margin: 0 5px;
            font-weight: bold;
        }
        input:focus { outline: none; border-color: var(--primary); }

        /* Buttons */
        .btn-group { margin-top: 20px; display: flex; gap: 10px; }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.2s;
            font-size: 1rem;
        }
        
        .btn-calc { background-color: var(--primary); color: white; }
        .btn-hint { background-color: var(--secondary); color: white; }
        .btn-sol { background-color: #0f172a; color: white; }
        button:hover { opacity: 0.9; }

        /* Results & Feedback */
        #feedback { margin-top: 20px; }
        .error { color: #dc2626; font-weight: bold; padding: 10px; background: #fee2e2; border-radius: 6px; }
        .result-box {
            font-size: 1.2em;
            padding: 20px;
            background: #f1f5f9;
            border-radius: 8px;
            border: 1px solid #cbd5e1;
        }

        .hidden-content { display: none; }
        
        .math-highlight {
            font-family: 'Courier New', monospace;
            background: #e2e8f0;
            padding: 2px 6px;
            border-radius: 4px;
        }
    </style>
</head>
<body>

<div class="container">
    
    <div class="card">
        <h1>High School Math Challenge: Geometric Optimization</h1>
        <p>
            You have the integers <strong>2, 3, 4, 5, 6, 7</strong>. 
            Your mission is to place each number exactly once into the boxes below to define two convergent geometric sequences.
        </p>
        <p>
            The goal: <strong>Make the difference \( D \) between their Sums to Infinity as large as possible.</strong>
        </p>
        <div style="text-align: center; font-size: 1.2em; font-weight: bold;">
            Maximize \( D = | S_{\infty}(u) - S_{\infty}(v) | \)
        </div>
    </div>

    <div class="card">
        <h2>Part 1: The Concept Refresher</h2>
        <p>Before guessing, let's understand the tools we are working with.</p>

        <div class="concept-box">
            <h3>1. The Formula</h3>
            The sum to infinity is calculated as:
            $$S_{\infty} = \frac{a}{1 - r}$$
            Where \(a\) is the first term and \(r\) is the common ratio.
        </div>

        <div class="concept-box">
            <h3>2. How to "Hack" the Formula</h3>
            To maximize the difference \(D\), we need one sum to be <strong>HUGE</strong> and the other to be <strong>TINY</strong>.
            
            <ul>
                <li><strong>To get a HUGE sum:</strong> We need a large numerator (\(a\)) and a tiny denominator (\(1-r\)). To get a tiny denominator, \(r\) must be extremely close to 1 (e.g., 0.99). This represents a "Gentle Slope" that goes on for a long time.</li>
                <li><strong>To get a TINY sum:</strong> We need a small numerator (\(a\)) and a large denominator. To get a large denominator, \(r\) should be small (close to 0). This represents a "Steep Drop".</li>
            </ul>
        </div>

        <div class="concept-box">
            <h3>3. Calculating Ratio (\(r\)) from Index</h3>
            If you know the start value (\(u_1\)) and the value at a specific position (\(u_{index}\)), the ratio is:
            $$ r = \left( \frac{\text{Value}}{\text{Start}} \right)^{\frac{1}{\text{Index} - 1}} $$
            <em>Tip: A larger Index (power) acts as a lever. It forces the ratio closer to 1.</em>
        </div>
    </div>

    <div class="card">
        <h2>Part 2: The Laboratory</h2>
        <p>Drag and drop the numbers mentally, then type them into the boxes below. Remember, use <strong>2, 3, 4, 5, 6, 7</strong> exactly once each.</p>

        <div class="interaction-area">
            <div class="sequence-u">
                <span class="sequence-header" style="color: var(--accent-u)">Sequence U (Target: HUGE)</span>
                <div class="input-row">
                    \( u_1 = \) <input type="number" id="u1" placeholder="#">
                </div>
                <div class="input-row">
                    At Index <input type="number" id="u_idx" placeholder="idx">,
                </div>
                <div class="input-row">
                    the value is <input type="number" id="u_val" placeholder="val">
                </div>
            </div>

            <div class="sequence-v">
                <span class="sequence-header" style="color: var(--accent-v)">Sequence V (Target: TINY)</span>
                <div class="input-row">
                    \( v_1 = \) <input type="number" id="v1" placeholder="#">
                </div>
                <div class="input-row">
                    At Index <input type="number" id="v_idx" placeholder="idx">,
                </div>
                <div class="input-row">
                    the value is <input type="number" id="v_val" placeholder="val">
                </div>
            </div>
        </div>

        <div class="btn-group">
            <button class="btn-calc" onclick="calculate()">Check My Result</button>
            <button class="btn-hint" onclick="toggleHint()">Need a Hint?</button>
            <button class="btn-sol" onclick="toggleSolution()">Reveal Answer</button>
        </div>

        <div id="hint-box" class="concept-box hidden-content">
            <strong>Hint:</strong> Group your numbers into "Big numbers" and "Small numbers". 
            Use {5, 6, 7} for the sequence you want to be huge. Use {2, 3, 4} for the sequence you want to be tiny.
            <br><br>
            To make \(r\) close to 1 (huge sum), you want the sequence to decrease <em>very slowly</em>. That means the Start Value and the Later Value should be close together, and the Index should be far away.
        </div>

        <div id="feedback"></div>
    </div>

    <div id="solution-section" class="card hidden-content">
        <h2>Part 3: The Detailed Solution</h2>
        
        <h3>Step 1: Divide and Conquer</h3>
        <p>We want \(S_u\) to be max and \(S_v\) to be min. We have numbers {2, 3, 4, 5, 6, 7}.</p>
        <ul>
            <li>For \(S_u\) (Max), we should use the largest numbers available: <strong>5, 6, 7</strong>.</li>
            <li>For \(S_v\) (Min), we should use the smallest numbers available: <strong>2, 3, 4</strong>.</li>
        </ul>

        <h3>Step 2: Optimizing Sequence U (The Huge Sum)</h3>
        <p>We need \(S_u = \frac{a}{1-r}\) to be huge.</p>
        <ol>
            <li><strong>Maximize \(a\):</strong> We choose our largest number, <strong>6</strong>, as the start (\(u_1\)). (Note: We save 7 for the index, because the exponent is more powerful than the base).</li>
            <li><strong>Maximize \(r\):</strong> We want \(r\) close to 1. This means the sequence shouldn't drop much. We set the value to <strong>5</strong>.</li>
            <li><strong>Stretch it out:</strong> To make the drop from 6 to 5 take as long as possible (keeping \(r\) high), we use the largest index, <strong>7</strong>.</li>
        </ol>
        <p>$$ u_1 = 6, \quad u_7 = 5 $$</p>

        <h3>Step 3: Optimizing Sequence V (The Tiny Sum)</h3>
        <p>We need \(S_v = \frac{a}{1-r}\) to be tiny.</p>
        <ol>
            <li><strong>Minimize \(a\):</strong> We want a small start. Let's try <strong>4</strong>. (Why not 2? Because we must use 2, 3, and 4 exactly once, and we need the later term to be smaller than the start. If we used 2 as the start, there would be no smaller number left for the later term.)</li>
            <li><strong>Minimize \(r\):</strong> We want the sequence to crash quickly. We set the target value to our smallest number, <strong>2</strong>.</li>
            <li><strong>Keep it short:</strong> We use the smallest remaining index, <strong>3</strong>, so the drop happens fast.</li>
        </ol>
        <p>$$ v_1 = 4, \quad v_3 = 2 $$</p>

        <h3>Final Calculation</h3>
        <div class="concept-box">
            <strong>Sequence U:</strong> \( r = (5/6)^{1/6} \approx 0.97 \). Sum \(\approx 200.47\)<br>
            <strong>Sequence V:</strong> \( r = (2/4)^{1/2} \approx 0.707 \). Sum \(\approx 13.66\)<br>
            <hr>
            <strong>Difference \(D = 200.47 - 13.66 = 186.81\)</strong>
        </div>
    </div>

</div>

<script>
    function calculate() {
        const u1 = parseFloat(document.getElementById('u1').value);
        const u_idx = parseFloat(document.getElementById('u_idx').value);
        const u_val = parseFloat(document.getElementById('u_val').value);
        
        const v1 = parseFloat(document.getElementById('v1').value);
        const v_idx = parseFloat(document.getElementById('v_idx').value);
        const v_val = parseFloat(document.getElementById('v_val').value);

        const feedback = document.getElementById('feedback');
        feedback.innerHTML = ""; // Clear previous

        // 1. Basic Validation
        const inputs = [u1, u_idx, u_val, v1, v_idx, v_val];
        if (inputs.some(isNaN)) {
            feedback.innerHTML = "<div class='error'>‚ö†Ô∏è Please fill in all 6 boxes.</div>";
            return;
        }

        // 2. Uniqueness Validation
        const sorted = [...inputs].sort((a,b) => a-b);
        const expected = [2, 3, 4, 5, 6, 7];
        const isSetCorrect = JSON.stringify(sorted) === JSON.stringify(expected);

        if (!isSetCorrect) {
            feedback.innerHTML = "<div class='error'>‚ö†Ô∏è You must use the integers 2, 3, 4, 5, 6, 7 exactly once. Check for duplicates or invalid numbers.</div>";
            return;
        }

        // 3. Logic Validation (Convergence)
        // r must be < 1. Since numbers are positive, Value must be < Start.
        if (u_val >= u1) {
            feedback.innerHTML = "<div class='error'>‚ö†Ô∏è Sequence U Error: For a geometric sequence to have a Sum to Infinity, it must decrease. Your value ("+u_val+") is not smaller than start ("+u1+").</div>";
            return;
        }
        if (v_val >= v1) {
            feedback.innerHTML = "<div class='error'>‚ö†Ô∏è Sequence V Error: For a geometric sequence to have a Sum to Infinity, it must decrease. Your value ("+v_val+") is not smaller than start ("+v1+").</div>";
            return;
        }

        // 4. Calculations
        // Formula: Value = Start * r^(idx-1)  ->  r = (Value/Start)^(1/(idx-1))
        const r_u = Math.pow(u_val / u1, 1 / (u_idx - 1));
        const r_v = Math.pow(v_val / v1, 1 / (v_idx - 1));

        const sum_u = u1 / (1 - r_u);
        const sum_v = v1 / (1 - r_v);

        const diff = Math.abs(sum_u - sum_v);

        // 5. Display Results
        let msg = `<div class="result-box">`;
        
        msg += `<p><strong>Sequence U (The Big One):</strong><br>`;
        msg += `Ratio \(r\) = ${r_u.toFixed(4)}<br>`;
        msg += `Sum = ${sum_u.toFixed(2)}</p>`;

        msg += `<p><strong>Sequence V (The Small One):</strong><br>`;
        msg += `Ratio \(r\) = ${r_v.toFixed(4)}<br>`;
        msg += `Sum = ${sum_v.toFixed(2)}</p>`;

        msg += `<hr>`;
        msg += `<h3 style="color:var(--primary); text-align:center;">Difference D = ${diff.toPrecision(5)}</h3>`;
        
        // Success condition checks for approx 186.81
        if (diff > 186 && diff < 187) {
            msg += `<p style="text-align:center; color: green; font-weight:bold;">üéâ Outstanding! You found the maximum value.</p>`;
        } else if (diff > 100) {
            msg += `<p style="text-align:center; color: orange;">Good job! You're on the right track, but you can squeeze out a bigger difference.</p>`;
        } else {
            msg += `<p style="text-align:center; color: var(--secondary);">Keep trying! Remember: Maximize U, Minimize V.</p>`;
        }

        msg += `</div>`;

        feedback.innerHTML = msg;
        MathJax.typeset(); // Refresh math
    }

    function toggleHint() {
        const el = document.getElementById('hint-box');
        el.style.display = (el.style.display === 'block') ? 'none' : 'block';
    }

    function toggleSolution() {
        const el = document.getElementById('solution-section');
        el.style.display = (el.style.display === 'block') ? 'none' : 'block';
        MathJax.typeset();
    }
</script>

</body>
</html>

